#----By--Mugiw4r4------

#!/usr/bin/env python3

import scapy.all as scapy
import argparse

def get_arg():
    parser=argparse.ArgumentParser()
    parser.add_argument('-t','--target',dest='target',help='Target IP / Target range of IPs')
    args = parser.parse_args()
    return args

def scan(ip):
    arp_req=scapy.ARP(pdst=ip)
    broadcast=scapy.Ether(dst='ff:ff:ff:ff:ff:ff')
    arp_req_broadcast = broadcast/arp_req
    answered = scapy.srp(arp_req_broadcast, timeout=1,verbose=False)[0]
    listing=[]
    for elt in answered:
        listing.append({"ip_address":elt[1].psrc ,"MAC_address" : elt[1].hwsrc})
    return listing


def print_result(listing):
    print("IP ADDRESS" + '\t\t\t' + "MAC_ADDRESS" + '\n---------------------------------------------')
    for elt in listing :
        print(elt["ip_address"]+'\t\t\t'+elt["MAC_address"])

target=get_arg().target
print_result(scan(target))

